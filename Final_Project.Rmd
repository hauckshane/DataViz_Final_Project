---
title: "Final Project"
author: "Shane Hauck"
date: '2022-03-21'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

```{r}
epl_standard <- read_csv("data/epl_standard.csv") %>% 
  select(-c(3, Matches)) %>%
  separate(Nation, into = c("irrel", "Nation"), sep = " ") %>%
  select(-c(irrel))
epl_standard
```

```{r}
epl_shooting <- read_csv("data/epl_shooting.csv", skip = 1) %>% 
  select(-c(3, Matches)) %>%
  separate(Nation, into = c("irrel", "Nation"), sep = " ") %>%
  select(-c(irrel)) %>%
  select(-c(Rk, Born, `90s`, FK, PK, PKatt))
epl_shooting

epl_shooting_max <- epl_shooting %>% drop_na() %>%
  summarise_if(is.numeric, max)
epl_shooting_min <- epl_shooting %>% drop_na() %>%
  summarise_if(is.numeric, min)
```

```{r}
epl_passing <- read_csv("data/epl_passing.csv") %>% 
  select(-c(3, Matches)) %>%
  separate(Nation, into = c("irrel", "Nation"), sep = " ") %>%
  select(-c(irrel))
epl_passing 
```

```{r}
epl_passtype <- read_csv("data/epl_passtypes.csv", skip = 1) %>% 
  select(-c(3, Matches)) %>%
  separate(Nation, into = c("irrel", "Nation"), sep = " ") %>%
  select(-c(irrel))
epl_passtype
```

```{r}
epl_goalandshotcreation <- read_csv("data/epl_goalandshotcreation.csv", skip = 1) %>% 
  select(-c(3, Matches)) %>%
  separate(Nation, into = c("irrel", "Nation"), sep = " ") %>%
  select(-c(irrel))
epl_goalandshotcreation 
```

```{r}
epl_defensiveactions <- read_csv("data/epl_defensiveactions.csv", skip = 1) %>% 
  select(-c(3, Matches)) %>%
  separate(Nation, into = c("irrel", "Nation"), sep = " ") %>%
  select(-c(irrel))
epl_defensiveactions
``` 

```{r}
epl_possesion <- read_csv("data/epl_possesion.csv", skip = 1) %>%
  select(-c(3, Matches)) %>%
  separate(Nation, into = c("irrel", "Nation"), sep = " ") %>%
  select(-c(irrel))
epl_possesion
```

```{r}
epl_miscellaneous <- read_csv("data/epl_miscellaneous.csv", skip = 1) %>% 
  select(-c(3, Matches)) %>%
  separate(Nation, into = c("irrel", "Nation"), sep = " ") %>%
  select(-c(irrel))
epl_miscellaneous
```

```{r}
epl_goalkeeper <- read_csv("data/epl_goalkeeper.csv", skip = 1) %>% 
  select(-c(3, Matches)) %>%
  separate(Nation, into = c("irrel", "Nation"), sep = " ") %>%
  select(-c(irrel))
epl_goalkeeper
```

```{r}
epl_goalkeeperadvanced <- read_csv("data/epl_goalkeeperadvanced.csv", skip = 1) %>% 
  select(-c(3, Matches)) %>%
  separate(Nation, into = c("irrel", "Nation"), sep = " ") %>%
  select(-c(irrel))
epl_goalkeeperadvanced
```


```{r}
# Library
library(fmsb)
 
# Create data: note in High school for Jonathan:
data <- as.data.frame(matrix( sample( 2:20 , 10 , replace=T) , ncol=10))
colnames(data) <- c("math" , "english" , "biology" , "music" , "R-coding", "data-viz" , "french" , "physic", "statistic", "sport" )
 
# To use the fmsb package, I have to add 2 lines to the dataframe: the max and min of each topic to show on the plot!
data <- rbind(rep(20,10) , rep(0,10) , data)
 
# Check your data, it has to look like this!
head(data)

# The default radar chart 
radarchart( data  , axistype=1 , 
 
    #custom polygon
    pcol=rgb(0.2,0.5,0.5,0.9) , pfcol=rgb(0.2,0.5,0.5,0.5) , plwd=4 , 
 
    #custom the grid
    cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20,5), cglwd=0.8,
 
    #custom labels
    vlcex=0.8 
    )
```


```{r}
epl_standard_player <- epl_standard %>% filter(Name == "Max Aarons")

epl_standard_max <- epl_standard %>% summarise_if(is.numeric, max)
epl_standard_min <- epl_standard %>% summarise_if(is.numeric, min)

epl_standard_half <- full_join(epl_standard_min, epl_standard_player)
epl_standard_full <- full_join(epl_standard_max, epl_standard_half) %>%
  select(-c(Born, Name, Nation, Pos, Squad, Age))


radarchart(epl_standard_full, pcol= "green", pfcol = rgb(0.2,0.5,0.5,0.75), 
            cglty = 1, axislabcol = "red", cglwd = 1,
           vlcex =0.8)
```

```{r}
epl_shoot_player <- epl_shooting %>% filter(Name == "Harry Kane")



epl_shoot_half <- full_join(epl_shooting_min, epl_shoot_player)
epl_shoot_full <- full_join(epl_shooting_max, epl_shoot_half) %>%
  select(-c(Age, Squad, Pos, Nation, Name))


radarchart(epl_shoot_full, pcol= "green", pfcol = rgb(0.2,0.5,0.5,0.75), 
            cglty = 1, axislabcol = "red", cglwd = 1,
           vlcex =0.8)

library(plotly)


```



```{r}
# Library
library(fmsb)
 
# Create data: note in High school for several students
set.seed(99)
data <- as.data.frame(matrix( sample( 0:20 , 15 , replace=F) , ncol=5))
colnames(data) <- c("math" , "english" , "biology" , "music" , "R-coding" )
rownames(data) <- paste("mister" , letters[1:3] , sep="-")
 
# To use the fmsb package, I have to add 2 lines to the dataframe: the max and min of each variable to show on the plot!
data <- rbind(rep(20,5) , rep(0,5) , data)

# Color vector
colors_border=c( rgb(0.2,0.5,0.5,0.9), rgb(0.8,0.2,0.5,0.9) , rgb(0.7,0.5,0.1,0.9) )
colors_in=c( rgb(0.2,0.5,0.5,0.4), rgb(0.8,0.2,0.5,0.4) , rgb(0.7,0.5,0.1,0.4) )

# plot with default options:
radarchart( data  , axistype=1 , 
    #custom polygon
    pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
    #custom the grid
    cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20,5), cglwd=0.8,
    #custom labels  
    vlcex=0.8 
    )

# Add a legend
legend(x=0.7, y=1, legend = rownames(data[-c(1,2),]), bty = "n", pch=20 , col=colors_in , text.col = "grey", cex=1.2, pt.cex=3)
```


```{r}
epl_standard_player <- epl_standard %>% filter(Name == "Ivan Toney" | Name == "Max Aarons") 

epl_standard_max <- epl_standard %>% summarise_if(is.numeric, max)
epl_standard_min <- epl_standard %>% summarise_if(is.numeric, min)

epl_standard_half <- full_join(epl_standard_min, epl_standard_player)
epl_standard_full <- full_join(epl_standard_max, epl_standard_half) %>%
  select(-c(Born, Name, Nation, Pos, Squad, Age))


radarchart(epl_standard_full)
```

```{r}
test_player <- epl_standard %>% filter(Name == "Ivan Toney")
epl_standard_max <- epl_standard %>% summarise_if(is.numeric, max)
epl_standard_min <- epl_standard %>% summarise_if(is.numeric, min)

epl_standard_half <- full_join(epl_standard_min, test_player)
epl_standard_full <- full_join(epl_standard_max, epl_standard_half) %>%
  select(-c(Born, Name, Nation, Pos, Squad, Age))
test <- radarchart(epl_standard_full)
```


```{r}
library(shiny)

ui <- fluidPage(
  sidebarLayout(sidebarPanel(
    selectizeInput("playerchoice",
                   label = "Choose a Player",
                   choices = levels(factor(epl_standard$Name)))
    
  ),
  mainPanel(plotOutput("radarChart"))
  )
)

server <- function(input, output, session) {
  
  epl_standard_player <- 
    reactive({
      epl_standard %>% filter(Name == input$playerchoice)
    })
  
  epl_standard_half <- 
    reactive({
      full_join(epl_standard_min, epl_standard_player())
    })
  
  epl_standard_full <- 
    reactive({
      full_join(epl_standard_max, epl_standard_half()) %>%
        select(-c(Born, Name, Nation, Pos, Squad, Age))
    })
  
  radar_chart <- 
    reactive({
      radarchart(epl_standard_full())
    })
  
  output$radarChart <- renderPlot({
    radar_chart()
  })
}

shinyApp(ui, server)
```



```{r}
library(plotly)

fig <- plot_ly(
    type = 'scatterpolar',
    r = c(39, 28, 8, 7, 28),
    theta = c('A','B','C', 'D', 'E'),
    fill = 'toself'
  ) 
fig <- fig %>%
  layout(
    polar = list(
      radialaxis = list(
        visible = T,
        range = c(0,100)
      )
    ),
    showlegend = T
  )

fig

fig2 <- plot_ly(
  type = 'scatterpolar',
  r = epl_standard %>% filter(Name == "Phil Foden") %>% select(where(is.numeric)) %>% select(-c(Born, Rk)) ,
  theta = colnames(epl_standard %>% select(-c(Born, Rk)) %>% select(where(is.numeric))),
  fill = 'toself'
)
fig2 <- fig2 %>%
  layout(
    polar = list(
      radialaxis = list(
        range = c(0, epl_standard_max)
      )
    )
  )
fig2
```

```{r}
library(ggradar)
library(dplyr)
library(scales)
library(tibble)

mtcars_radar <- mtcars %>%
  as_tibble(rownames = "group") %>%
  mutate_at(vars(-group), rescale) %>%
  tail(4) %>%
  select(1:10)
mtcars_radar
ggradar(mtcars_radar, interactive = TRUE)

```

```{r}
library(ggiraphExtra)

require(ggplot2)
require(ggiraph)
require(plyr)
require(reshape2)
require(moonBook)
require(sjmisc)
ggRadar(data=iris,aes(group=Species))
ggRadar(data=mtcars,interactive=TRUE)
ggRadar(data=mtcars,aes(colour=am,facet=cyl),interactive=TRUE)
ggRadar(data=acs,aes(colour=Dx,facet=Dx))
ggRadar(iris,aes(x=c(Sepal.Length,Sepal.Width,Petal.Length,Petal.Width)), interactive = TRUE)
```

```{r}
mtcars_radar <- mtcars %>%
 as_tibble(rownames = "group") %>%
   mutate_at(vars(-group), rescale) %>%
   tail(4) %>%
   select(1:10)
 mtcars_radar
 ggradar(mtcars_radar)

```


```{r}
mtcars_theta = c('drat','wt','qsec','vs','am','drat')


p <- plot_ly(
  type = 'scatterpolar',
  fill = 'toself'
) %>%
  add_trace(
    r = c(0.359447,0.5259524,0.0119047, 0, 1, 0.359447),
    theta = mtcars_theta,
    name = 'Maserati Bora'
  ) %>%
  add_trace(
    r = c(0.6221198, 0.3239581, 0.4880952, 1, 1, 0.6221198),
    theta = mtcars_theta,
    name = 'Volvo 142E'
  ) %>%
  layout(
    polar = list(
      radialaxis = list(
        visible = TRUE,
        range = c(0,1)
      )
    )
  )
 
p
```

```{r}
library(plotly)
library(fmsb)

data <- as.data.frame(matrix( sample( 2:20 , 10 , replace=T) , ncol=10))
colnames(data) <- c("math" , "english" , "biology" , "music" , "R-coding", "data-viz" , "french" , "physic", "statistic", "sport" )

data <- rbind(rep(20,10) , rep(0,10) , data)

p <- radarchart( data  , axistype=1 , 
    pcol=rgb(0.2,0.5,0.5,0.9) , pfcol=rgb(0.2,0.5,0.5,0.5) , plwd=4 , 
    cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20,5), cglwd=0.8,
    vlcex=0.8 
    )
ggplotly(p)
```


